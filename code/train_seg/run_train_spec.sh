# --labeled_data_root path_to/image_dir include two 2 subdirs which are img and mask

python3 train_cv_v1.py --num_classes 2 \
                  --labeled_data_root path_to/image_dir \
                  --l_train_wsi_data_list_path path_to/train.txt \
                  --l_val_wsi_data_list_path path_to/val.txt \
                  --wsi_data_details_info_root path_to/details_info \
                  --neg_wsi_data_list_path path_to_data/pure_neg_data_list_example.csv \
                  --neg_data_root_path path_to_data/neg_sample_data \
                  --random_image_size 1024,3072 \
                  --random_size_ratio 0.2 \
                  --crop_size 2048 \
                  --train_n_sample 1200 \
                  --val_n_sample 120 \
                  --lr 0.0001 \
                  --epochs 100 \
                  --name model_exp_1_20x_2048 \
                  --optimizer RAdam \
                  --min_lr 0.00001 \
                  -b 8 \
                  --num_workers 36 \
                  --class_name bg,ca \
                  --show_arch False \
                  --mix_precision True \
                  --encoder timm-regnety_040 \
                  --encoder_weight imagenet \
                  --arch deeplabv3plus \
                  --mode multiclass \
                  --tf_log_path path_to_logs/tf_log \
                  --loss tversky,focal \
                  --loss_weight 0.1,0.9 \
                  --act softmax2d \
                  --ignore_index 2 \
                  --scheduler CosineAnnealingWarmupRestarts \
                  --cosine_cycle_steps 20 \
                  --cosine_cycle_warmup 5 \
                  --cosine_cycle_gamma 1.0 \
                  --output_dir path_to_models \
                  --train_neg_ratio 0.05 \
                  --train_pure_bg_ratio 0.35 \
                  --train_mix_ratio 0.2 \
                  --hard_sample_ratio 0.05 \
                  --val_neg_ratio 0.15 \
                  --val_pure_bg_ratio 0.35 \
                  --val_mix_ratio 0.4 \
                  --test_neg_ratio 0.15 \
                  --test_pure_bg_ratio 0.35 \
                  --test_mix_ratio 0.4 \
                  --hard_sample_csv path_to_data/hard_sample_list_example.csv \
                  --pretrain_model path_to_models/pretrain_model.pth
                  
python3 train_cv_v2.py --num_classes 2 \
                  --labeled_data_root path_to/image_dir \
                  --l_train_wsi_data_list_path path_to_data/train.txt \
                  --l_val_wsi_data_list_path path_to_data/val.txt \
                  --wsi_data_details_info_root path_to_data/details_info \
                  --neg_wsi_data_list_path path_to_data/pure_neg_data_list_example.csv \
                  --neg_data_root_path path_to_data/neg_sample_data \
                  --random_image_size 1024,3072 \
                  --random_size_ratio 0.2 \
                  --crop_size 2048 \
                  --train_n_sample 1200 \
                  --val_n_sample 120 \
                  --lr 0.0001 \
                  --epochs 100 \
                  --name model_exp_1_20x_2048 \
                  --optimizer RAdam \
                  --min_lr 0.00001 \
                  -b 8 \
                  --num_workers 36 \
                  --class_name bg,ca \
                  --show_arch False \
                  --mix_precision True \
                  --encoder timm-regnety_040 \
                  --encoder_weight imagenet \
                  --arch deeplabv3plus \
                  --mode multiclass \
                  --tf_log_path path_to_logs/tf_log \
                  --loss tversky,focal \
                  --loss_weight 0.1,0.9 \
                  --act softmax2d \
                  --ignore_index 2 \
                  --scheduler CosineAnnealingWarmupRestarts \
                  --cosine_cycle_steps 20 \
                  --cosine_cycle_warmup 5 \
                  --cosine_cycle_gamma 1.0 \
                  --output_dir path_to_models \
                  --train_neg_ratio 0.05 \
                  --train_pure_bg_ratio 0.35 \
                  --train_mix_ratio 0.2 \
                  --hard_sample_ratio 0.1 \
                  --val_neg_ratio 0.05 \
                  --val_pure_bg_ratio 0.4 \
                  --val_mix_ratio 0.4 \
                  --test_neg_ratio 0.05 \
                  --test_pure_bg_ratio 0.4 \
                  --test_mix_ratio 0.4 \
                  --hard_sample_dir path_to_data/false_neg_mask \
                  --pretrain_model path_to_models/pretrain_model.pth
